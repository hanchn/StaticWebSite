<!-- Page Header -->
<header class="page-header">
  <h1 class="page-title"><%= page.title %></h1>
  <% if (page.description) { %>
  <p class="page-description"><%= page.description %></p>
  <% } %>
  
  <div class="page-meta">
    <% if (page.date) { %>
    <time class="page-date" datetime="<%= new Date(page.date).toISOString() %>">
      更新于 <%= new Date(page.date).toLocaleDateString('zh-CN') %>
    </time>
    <% } %>
    <% if (page.author) { %>
    <span class="page-author">作者: <%= page.author %></span>
    <% } %>
  </div>
</header>

<!-- Page Content -->
<article class="page-content">
  <%- page.content %>
</article>

<!-- Page Footer -->
<% if (page.showFooter !== false) { %>
<footer class="page-footer">
  <div class="page-actions">
    <% if (page.showEdit) { %>
    <a href="#" class="btn btn-secondary">编辑此页面</a>
    <% } %>
    
    <% if (page.showShare) { %>
    <div class="page-share">
      <h4>分享此页面</h4>
      <div class="share-buttons">
        <a href="https://twitter.com/intent/tweet?text=<%= encodeURIComponent(page.title) %>&url=<%= encodeURIComponent(site.url + page.url) %>" target="_blank" class="share-btn twitter">
          <span class="share-icon">🐦</span>
          Twitter
        </a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=<%= encodeURIComponent(site.url + page.url) %>" target="_blank" class="share-btn facebook">
          <span class="share-icon">📘</span>
          Facebook
        </a>
        <a href="mailto:?subject=<%= encodeURIComponent(page.title) %>&body=<%= encodeURIComponent('我发现了一个有趣的页面：' + page.title + ' ' + site.url + page.url) %>" class="share-btn email">
          <span class="share-icon">📧</span>
          Email
        </a>
      </div>
    </div>
    <% } %>
  </div>
  
  <% if (page.lastModified) { %>
  <div class="page-info">
    <p class="last-modified">最后更新: <%= new Date(page.lastModified).toLocaleDateString('zh-CN') %></p>
  </div>
  <% } %>
</footer>
<% } %>

<!-- Table of Contents (if enabled) -->
<% if (page.showToc) { %>
<aside class="page-toc">
  <h3>目录</h3>
  <div id="toc-container">
    <!-- TOC will be generated by JavaScript -->
  </div>
</aside>

<script>
// 自动生成目录
(function() {
  const tocContainer = document.getElementById('toc-container');
  const headings = document.querySelectorAll('.page-content h2, .page-content h3, .page-content h4');
  
  if (headings.length === 0) {
    tocContainer.parentElement.style.display = 'none';
    return;
  }
  
  const toc = document.createElement('ul');
  toc.className = 'toc-list';
  
  headings.forEach((heading, index) => {
    // 为标题添加 ID
    if (!heading.id) {
      heading.id = `heading-${index}`;
    }
    
    const li = document.createElement('li');
    li.className = `toc-item toc-${heading.tagName.toLowerCase()}`;
    
    const a = document.createElement('a');
    a.href = `#${heading.id}`;
    a.textContent = heading.textContent;
    a.className = 'toc-link';
    
    li.appendChild(a);
    toc.appendChild(li);
  });
  
  tocContainer.appendChild(toc);
  
  // 平滑滚动
  document.querySelectorAll('.toc-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({ behavior: 'smooth' });
      }
    });
  });
})();
</script>
<% } %>